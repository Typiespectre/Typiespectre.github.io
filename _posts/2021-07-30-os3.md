---
title: "OSTEP - 가상화: 제한적 직접 실행 원리"
lang: "ko"
layout: post
date: 2021-07-30 16:23:27 +0900
categories: [os,]
tags: [os,]
---

(OSTEP의 가상화 파트 중, 제한적 직접 실행 원리에 대해 정리하는 글입니다.)

프로세스는 실행중인 프로그램을 의미한다. 그리고 CPU는 프로그램의 명령어와 코드를 한 줄씩 실행한다. CPU는 한 순간에 하나의 프로세스만 실행할 수 있음에도 불구하고, CPU의 가상화를 통해 우리는 일상에서 여러 개의 프로그램을 동시에 수행하는 듯한 인상을 받게 된다. CPU를 가상화하기 위해 운영체제는 여러 작업들이 동시에 실행되는 것처럼 보이도록 물리적인 CPU를 공유한다. 어떠한 방식으로 공유하는가? 기본적인 아이디어는 간단하다. 각 프로세스마다 CPU 할당 시간을 잘게 나누어 줌으로써, CPU가 프로세스들을 아주 짧은 간격으로 번갈아 실행하게 되는 방식이다. (이를 애니메이션 프레임으로 비유할 수 있을까?)

하지만 이러한 가상화 기법의 구현에는 두 가지 문제가 따른다. 첫 번째는 *성능 저하*이고, 두 번째는 *제어 문제*이다. CPU에 대한 통제를 유지하면서 프로세스를 효율적으로 실행시킬 수 있는 방법은 무엇인가? 특히 운영체제의 입장에서 제어 문제는 중요하다. 제어권을 상실하면 한 프로세스의 무한 루프를 중단할 수도 없을 뿐더러 사용자의 컴퓨터를 지배하고자 하는 악의적인 프로세스를 막을 방도가 없어지기 때문이다. 제어를 잃지 않기 위해선 하드웨어와 운영체제의 지원이 필수적이다.

운영체제 개발자들은 프로그램을 빠르게 실행하기 위하여 **제한적 직접 실행(Limited Direct Execution)**이라는 기법을 개발하였다. 이 아이디어의 "직접 실행"에 해당하는 부분은 간단하다. 프로그램을 CPU 상에서 그냥 직접 실행시키는 것이다. 그러나 프로그램을 직접 실행하는 방식에는 두 가지 문제점이 있다. 첫 번째로, 악의적인 프로그램에 대해 운영체제의 제어권을 지킬 수가 없다. 두 번째로, 운영체제가 프로그램의 실행을 중단하고 다른 프로세스로 전환하는 **시분할(time sharing)** 기법을 구현할 수 없다. 프로그램의 실행에 제한을 두지 않으면, 운영체제는 어떠한 것도 제어할 수 없는 단순한 라이브러리가 된다.

![os-de.jpg](https://typiespectre.github.io/images/os-de.png){: width="90%" height="90%"}

작성중...
