---
title: "OSTEP - 가상화: 멀티 레벨 피드백 큐"
lang: "ko"
layout: post
date: 2021-08-21 23:50:42 +0900
categories: [os,]
tags: [os,]
---

이전 라운드 로빈(RR)과 같은 알고리즘이 산출하는 응답 시간은 짧지만, 반환 시간은 거의 최악이었다. 그렇다면 짧은 응답 시간과 반환 시간을 모두 가능하게 할 수 있는 알고리즘은 없는 것일까? 다행히도 **멀티 레벨 피드백 큐(Multi-level Feedback Queue, MLFQ)**라는 스케줄링 기법이 존재한다. MLFQ는 반환 시간과 응답 시간을 모두 최적화하며, 짧게 실행되는 대화형 작업에 대해서는 (SJF/STCF와 유사하게) 우수한 성능을 제공하고, 오래 실행되는 CPU-집중 워크로드에 대해서는 공정한 실행을 보장한다. 이러한 우수한 성능으로 많은 시스템들이 MLFQ를 기본 스케줄러로 채택하고 있다.

MLFQ는 기본적으로 여러 개의 **큐**로 구성되며, 각각 다른 **우선 순위(priority level)**가 배정된다. MLFQ는 높은 우선 순위를 가진 작업을 높은 우선 순위 큐에 배정하여 선택 실행한다. 하나의 큐에 둘 이상의 작업이 존재할 수 있는데, 이는 해당 작업들이 모두 같은 우선 순위를 가짐을 의미한다. 이 작업들 사이에서는 RR 스케줄링 알고리즘이 사용된다.

MLFQ 스케줄링의 핵심은, MLFQ가 우선 순위를 지정하는 방식에서, 각 작업에 고정된 우선 순위를 부여하는 것이 아니라, 각 작업의 _특성에 따라_ 동적으로 우선 순위를 부여한다는 점이다. 예를 들어, 반복적인 입출력으로 CPU를 양도하는 대화형 패턴의 작업은 우선 순위를 높게 유지하지만, 긴 시간 동안 CPU를 집중적으로 사용하는 작업은 우선 순위를 낮춘다. 이렇듯 MLFQ는 작업이 진행되는 동안 해당 작업의 정보를 얻고, _해당 정보_ 를 이용하여 _미래_ 행동을 예측한다.

```sh             
[High Priority] Q8 -> A -> B
                Q7          
                Q6          
                Q5          
                Q4 -> C     
                Q3          
                Q2          
[Low Priority]  Q1 -> D

(MLFQ의 예시)
```

